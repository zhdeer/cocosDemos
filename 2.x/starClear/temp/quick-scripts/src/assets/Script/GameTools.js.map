{"version":3,"sources":["assets\\Script\\GameTools.js"],"names":["GameConfig","require","GameTools","love2048FrameCache","numberLabelAtlas","backMusicIsPlay","playSimpleAudioEngine","engineType","IS_GAME_MUSIC","cc","audioEngine","play","url","raw","playBackgroundMusic","stopBackgroundMusic","stop","getItemByLocalStorage","key","value","values","sys","localStorage","getItem","undefined","setItem","Number","setItemByLocalStorage","toastMessage","toastType","loader","loadRes","err","prefab","node","instantiate","getComponent","Component","director","getScene","children","addChild","sharePicture","pictureName","titleStr","CC_WECHATGAME","window","wx","shareAppMessage","title","query","MAIN_MENU_NUM","imageUrl","canvas","toTempFilePathSync","destWidth","destHeight","success","res","shareTickets","length","postMessage","messageType","shareTicket","log","getGameIntegral","setGameIntegral","intrgral","commentGame","openCustomerServiceConversation","checkFirstLoginGame","loginDate","Math","floor","Date","getTime","setTimeout","setCardBackPath","num","userLogin","getRankData","removeRankData","submitScore","score","getSelectAddNum","module","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var GameConfig = require(\"GameConfig\");\nvar GameTools = {\n    love2048FrameCache: null,\n    numberLabelAtlas: null,\n    backMusicIsPlay: null,\n    playSimpleAudioEngine: function (engineType) {\n        if (GameConfig.IS_GAME_MUSIC) {\n            switch (engineType) {\n                case 0:\n                    cc.audioEngine.play(cc.url.raw('resources/sounds/pop_star.mp3'), false, 0.5);\n                    break;\n                case 1:\n                    cc.audioEngine.play(cc.url.raw('resources/sounds/select.mp3'), false, 0.5);\n                    break;\n                case 2:\n                    cc.audioEngine.play(cc.url.raw(\"resources/sounds/landing.mp3\"), false, 0.5);\n                    break;\n                case 3:\n                    cc.audioEngine.play(cc.url.raw(\"resources/sounds/cheers.mp3\"), false, 0.5);\n                    break;\n                default:\n                    break;\n            }\n        }\n    },\n    playBackgroundMusic: function () {\n        if (GameConfig.IS_GAME_MUSIC) {\n            if (GameTools.backMusicIsPlay == null) {\n                GameTools.backMusicIsPlay = cc.audioEngine.play(cc.url.raw('resources/sounds/backMusic.mp3'), true, 0.5);\n            }\n        }\n    },\n    stopBackgroundMusic: function () {\n        if (GameTools.backMusicIsPlay != null) {\n            cc.audioEngine.stop(GameTools.backMusicIsPlay);\n            GameTools.backMusicIsPlay = null;\n        }\n    },\n    getItemByLocalStorage: function (key, value) {\n        let values = cc.sys.localStorage.getItem(key);\n        if (values === undefined || values === null || values === '') {\n            cc.sys.localStorage.setItem(key, value);\n            return value;\n        }\n        if (typeof value === 'boolean') {\n            if (typeof values === 'boolean') {\n                return values;\n            }\n            return \"true\" == values;\n        } else if (typeof value === 'number') {\n            return Number(values);\n        }\n        return values;\n    },\n    setItemByLocalStorage: function (key, value) {\n        cc.sys.localStorage.setItem(key, value);\n    },\n    toastMessage(toastType) {\n        cc.loader.loadRes(\"panel/ShowMessage\", (err, prefab) => {\n            if (!err) {\n                var node = cc.instantiate(prefab);\n                node.getComponent(cc.Component).toastType = toastType;\n                cc.director.getScene().children[0].addChild(node);\n                // cc.director.getScene().getChildByName('Canvas').addChild(node);\n            }\n        });\n    }\n    , sharePicture(pictureName) {\n        let titleStr = '来跟我一起挑战浪漫2048吧。';\n        if (\"shareTicket\" == pictureName) {\n            titleStr = \"看看你在群里排第几？来和我挑战浪漫2048吧。\";\n        } else if (\"LotteryLayer\" == pictureName) {//抽奖页面分享\n            titleStr = \"浪漫2048福利大放送！快进来抽奖吧！\";\n        } else if (pictureName != undefined && pictureName != null) {\n            titleStr = \"我得了\" + pictureName + \"分,\" + titleStr;\n        }\n        if (CC_WECHATGAME) {\n            window.wx.shareAppMessage({\n                title: titleStr,\n                query: \"x=\" + GameConfig.MAIN_MENU_NUM,\n                imageUrl: canvas.toTempFilePathSync({\n                    destWidth: 500,\n                    destHeight: 400\n                }),\n                success: (res) => {\n                    if (res.shareTickets != undefined && res.shareTickets.length > 0) {\n                        if (\"shareTicket\" == pictureName) {\n                            window.wx.postMessage({\n                                messageType: 5,\n                                MAIN_MENU_NUM: GameConfig.MAIN_MENU_NUM == -1000 ? 1 : GameConfig.MAIN_MENU_NUM,\n                                shareTicket: res.shareTickets[0]\n                            });\n                        }\n                    }\n                }\n            });\n        } else {\n            cc.log(\"执行了截图\" + titleStr);\n        }\n    },\n    getGameIntegral() { //获取积分\n        return this.getItemByLocalStorage(\"GameIntegral\", 0);\n    },\n    setGameIntegral(intrgral) { // 设置积分\n        cc.sys.localStorage.setItem(\"GameIntegral\", intrgral);\n    }\n    , commentGame() { //评论\n        if (CC_WECHATGAME) {\n            window.wx.openCustomerServiceConversation({});\n        } else {\n            this.toastMessage(1);\n            cc.log(\"执行了评论\")\n        }\n    }\n    , checkFirstLoginGame() { //检查是否首次登录\n        let loginDate = Math.floor((new Date().getTime() - new Date(2018, 3, 18, 0, 0, 0, 0).getTime()) / (1000 * 60 * 60 * 24));\n        if (loginDate > this.getItemByLocalStorage(\"FirstEnterGameDate\", 0)) {\n            cc.sys.localStorage.setItem(\"FirstEnterGameDate\", loginDate);\n            setTimeout(() => {\n                this.setGameIntegral(this.getGameIntegral() + 100);\n                this.toastMessage(9);\n            }, 1500);\n        }\n    }\n\n    , setCardBackPath(num)//设置卡片背景路径\n    {\n        //GameConfig.setCardBackPath(num, \"card/nl2048.png\");\n    }\n\n    , userLogin() { //用户登录\n    }\n\n    , getRankData(shareTicket) { //获取排行榜\n        cc.loader.loadRes(\"panel/RankingListView\", (err, prefab) => {\n            if (!err) {\n                var node = cc.instantiate(prefab);\n                if (shareTicket != undefined) {\n                    node.getComponent(cc.Component).shareTicket = shareTicket;\n                }\n                // node.setPosition(cc.p(0, 0));\n                cc.director.getScene().children[0].addChild(node);\n            }\n        });\n    }\n    , removeRankData() {//移除排行榜数据\n        if (CC_WECHATGAME) {\n            window.wx.postMessage({\n                messageType: 0,\n            });\n        } else {\n            cc.log(\"移除排行榜数据。\");\n        }\n    }\n    , submitScore(score) { //提交得分\n        if (CC_WECHATGAME) {\n            window.wx.postMessage({\n                messageType: 3,\n                MAIN_MENU_NUM: GameConfig.MAIN_MENU_NUM,\n                score: score,\n            });\n        } else {\n            cc.log(\"提交得分:\" + GameConfig.MAIN_MENU_NUM + \" : \" + score)\n        }\n    }\n\n    , getSelectAddNum(num) //获取叠加数\n    {\n        if (num < 4) {\n            num = 2;\n        } else if (num < 8) {\n            num = 4;\n        } else if (num < 16) {\n            num = 8;\n        } else if (num < 32) {\n            num = 16;\n        } else if (num < 64) {\n            num = 32;\n        } else if (num < 128) {\n            num = 64;\n        } else if (num < 256) {\n            num = 128;\n        } else if (num < 512) {\n            num = 256;\n        } else if (num < 1024) {\n            num = 512;\n        } else if (num < 2048) {\n            num = 1024;\n        } else if (num < 4096) {\n            num = 2048;\n        } else if (num < 8192) {\n            num = 4096;\n        } else if (num < 16384) {\n            num = 8192;\n        } else if (num < 32768) {\n            num = 16384;\n        } else if (num < 65536) {\n            num = 32768;\n        } else if (num < 131072) {\n            num = 65536;\n        } else {\n            num = 131072;\n        }\n        return num;\n    }\n};\n\nmodule.exports = GameTools;"]}