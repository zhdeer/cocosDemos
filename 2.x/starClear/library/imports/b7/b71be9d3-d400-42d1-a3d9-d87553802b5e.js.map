{"version":3,"sources":["assets\\Script\\GameScene.js"],"names":["GamePopStar","require","GameData","GameTools","GameUiTools","GameConfig","AnimLayerTool","GameScene","cc","Class","Component","properties","layerBack","Sprite","backButton","Node","cardNumberTTF","Label","bestScoreTTF","progressBar","passNumTTF","propMenu","currentScore","isAddScore","gameLogicLayer","ctor","playBackgroundMusic","onLoad","GameLogic","addChild","score0","string","getGamePassScore","getGamePassNum","setButtonClickEvents","start","backButtonFunc","event","playSimpleAudioEngine","loadingResource","functionMenuTouchFunc","button","target","getGamePropNumber","propsMenu","PropsMenu","PropsMenuDestroyCard","showGamePropHelp","PropsMenuSpace","PropsMenuRemoveAcross","PropsMenuExchangeCard","propType","loader","loadRes","err","prefab","node","instantiate","getComponent","setPropType","director","getScene","children","setGamePropNumber","console","log","setScore","score","heightScore","scaleX","update","dt","setPassNum","stopBackgroundMusic","loadingSceneType","LoadingSceneType","LoadingSceneBackGame","loadScene"],"mappings":"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","sourceRoot":"/","sourcesContent":["var GamePopStar = require(\"GamePopStar\");\nvar GameData = require(\"GameData\");\nvar GameTools = require(\"GameTools\");\nvar GameUiTools = require(\"GameUiTools\");\nvar GameConfig = require(\"GameConfig\");\nvar AnimLayerTool = require(\"AnimLayerTool\");\nvar GameScene = cc.Class({\n    extends: cc.Component,\n    properties: {\n        layerBack: cc.Sprite,\n        backButton: cc.Node, //返回按钮\n        cardNumberTTF: cc.Label,// 显示分数控件\n        bestScoreTTF: cc.Label,// 显示最高分数控件\n        progressBar: cc.Node,//进度条\n        passNumTTF: cc.Label,//关数\n        propMenu: [cc.Node],//道具按钮\n\n        currentScore: 0,//当前得分\n        isAddScore: false,//是否加分\n\n        gameLogicLayer: cc.Node,\n    },\n    ctor: function () {\n        GameConfig.GameScene = this;\n        GameTools.playBackgroundMusic();\n    },\n    onLoad: function () {\n        GameConfig.GameLogic = new GamePopStar();\n        this.gameLogicLayer.addChild(GameConfig.GameLogic);\n\n        this.currentScore = GameData.score0;\n        this.cardNumberTTF.string = GameData.score0;\n        this.bestScoreTTF.string = GameData.getGamePassScore();\n        this.passNumTTF.string = \"第 \" + GameData.getGamePassNum() + \" 关\";\n        GameUiTools.setButtonClickEvents(this, this.backButton, \"backButtonFunc\");\n        GameUiTools.setButtonClickEvents(this, this.propMenu, \"functionMenuTouchFunc\");\n    },\n    start() {\n    },\n    backButtonFunc: function (event) {\n        GameTools.playSimpleAudioEngine(0);\n        this.loadingResource();\n    },\n    functionMenuTouchFunc: function (event) {\n        GameTools.playSimpleAudioEngine(0);\n        let button = event.target;\n        if (this.propMenu[0] == button) {\n            if (GameData.getGamePropNumber(0) >= 1) {\n                GameConfig.propsMenu = GameConfig.PropsMenu.PropsMenuDestroyCard;\n            } else {\n                this.showGamePropHelp(0);\n                GameConfig.propsMenu = GameConfig.PropsMenu.PropsMenuSpace;\n            }\n        } else if (this.propMenu[1] == button) {\n            if (GameData.getGamePropNumber(1) >= 1) {\n                GameConfig.propsMenu = GameConfig.PropsMenu.PropsMenuRemoveAcross;\n            } else {\n                this.showGamePropHelp(1);\n                GameConfig.propsMenu = GameConfig.PropsMenu.PropsMenuSpace;\n            }\n        } else if (this.propMenu[2] == button) {\n            if (GameData.getGamePropNumber(2) >= 1) {\n                GameConfig.propsMenu = GameConfig.PropsMenu.PropsMenuExchangeCard;\n            } else {\n                this.showGamePropHelp(2);\n                GameConfig.propsMenu = GameConfig.PropsMenu.PropsMenuSpace;\n            }\n        } else {\n            GameConfig.propsMenu = GameConfig.PropsMenu.PropsMenuSpace;\n        }\n    },\n    showGamePropHelp(propType) {\n        cc.loader.loadRes(\"panel/GamePropHelp\", (err, prefab) => {\n            let node = cc.instantiate(prefab);\n            node.getComponent(\"GamePropHelp\").setPropType(propType);\n            cc.director.getScene().children[0].addChild(node);\n        });\n    },\n    setGamePropNumber(propType) {\n\t\tconsole.log(\"00000000000000-------\");\n        this.propMenu[propType].getComponent(\"GamePropNode\").setPropType();\n    },\n    setScore: function (score) {\n        if (this.currentScore > score) {\n            this.currentScore = score;\n            this.cardNumberTTF.string = this.currentScore;\n        } else {\n            this.isAddScore = true;\n        }\n        if (score > GameData.heightScore) {\n            GameData.heightScore = score;\n\n        }\n        this.progressBar.scaleX = score / (GameData.getGamePassScore()) * 0.8;\n        if (this.progressBar.scaleX > 0.9) {\n            this.progressBar.scaleX = 0.9;\n        }\n    },\n    update: function (dt) {\n        if (this.isAddScore && this.currentScore <= GameData.score0) {\n            this.cardNumberTTF.string = this.currentScore++;\n            this.currentScore++;\n        } else {\n            this.isAddScore = false;\n        }\n    },\n    setPassNum() {\n        this.passNumTTF.string = \"第 \" + GameData.getGamePassNum() + \" 关\";\n        this.bestScoreTTF.string = GameData.getGamePassScore();\n    },\n    loadingResource: function () {\n        GameTools.stopBackgroundMusic();\n        GameConfig.loadingSceneType = GameConfig.LoadingSceneType.LoadingSceneBackGame;\n        cc.director.loadScene(\"LoadingScene\");\n    },\n});"]}