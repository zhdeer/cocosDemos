{"version":3,"sources":["assets\\Script\\LoadingScene.js"],"names":["GameData","require","GameTools","GameUiTools","GameConfig","AnimLayerTool","cc","Class","Component","properties","start","setTimeout","loadingResource","loadingSceneType","LoadingSceneType","LoadingSceneFirst","IS_GAME_MUSIC","getItemByLocalStorage","initFrameCache","initWxSetting","LoadingSceneEnterGame","IS_GAME_OVER","initData","heightScore","getHeightScore","isHaveGameData","loadGameData","setHaveGameData","setHeightScore","LoadingSceneBackGame","director","preloadScene","loadScene","loader","loadRes","LabelAtlas","err","atlas","numberLabelAtlas","CC_WECHATGAME","window","wx","onHide","stopBackgroundMusic","onShow","playBackgroundMusic","onAudioInterruptionBegin","onAudioInterruptionEnd","showShareMenu","withShareTicket","onShareAppMessage","title","imageUrl","canvas","toTempFilePathSync","destWidth","destHeight","LaunchOption","getLaunchOptionsSync","query","x","undefined","MAIN_MENU_NUM","Number","info","getSystemInfoSync","GameClubButton","createGameClubButton","icon","style","left","windowWidth","top","windowHeight","width","height","hide"],"mappings":"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","sourceRoot":"/","sourcesContent":["var GameData = require(\"GameData\");\nvar GameTools = require(\"GameTools\");\nvar GameUiTools = require(\"GameUiTools\");\nvar GameConfig = require(\"GameConfig\");\nvar AnimLayerTool = require(\"AnimLayerTool\");\ncc.Class({\n    extends: cc.Component,\n    properties: {},\n\n    start() {\n        setTimeout(() => {\n            this.loadingResource();\n        }, 10);\n    },\n\n    loadingResource() {\n        if (GameConfig.loadingSceneType == GameConfig.LoadingSceneType.LoadingSceneFirst) {\n            // GameTools.setGameIntegral(GameTools.getGameIntegral()+1000);\n            GameConfig.IS_GAME_MUSIC = GameTools.getItemByLocalStorage(\"IS_GAME_MUSIC\", true);\n            this.initFrameCache();\n            this.initWxSetting();\n        } else if (GameConfig.loadingSceneType == GameConfig.LoadingSceneType.LoadingSceneEnterGame) {\n            GameConfig.IS_GAME_OVER = false;\n            GameData.initData();\n            GameData.heightScore = GameData.getHeightScore();\n            if (GameData.isHaveGameData()) {\n                if (GameData.loadGameData(true) || GameData.heightScore < 0 || GameData.heightScore > 1073741824) {\n                    GameData.setHaveGameData(false);\n                    GameData.heightScore = 0;\n                    GameData.setHeightScore(0);\n                }\n            }\n        } else if (GameConfig.loadingSceneType == GameConfig.LoadingSceneType.LoadingSceneBackGame) {\n            if(!GameConfig.IS_GAME_OVER){\n                GameData.loadGameData(false);\n            }\n            // GameData.destroyInstance();\n        }\n\n        if (GameConfig.loadingSceneType == GameConfig.LoadingSceneType.LoadingSceneFirst) {\n            cc.director.preloadScene(\"MenuUI\", function () {\n                cc.director.loadScene(\"MenuUI\");\n            });\n        }\n        else if (GameConfig.loadingSceneType == GameConfig.LoadingSceneType.LoadingSceneEnterGame) {\n            cc.director.preloadScene(\"GameScene\", function () {\n                cc.director.loadScene(\"GameScene\");\n            });\n        }\n        else if (GameConfig.loadingSceneType == GameConfig.LoadingSceneType.LoadingSceneBackGame) {\n            cc.director.preloadScene(\"MenuUI\", function () {\n                cc.director.loadScene(\"MenuUI\");\n            });\n        }\n    },\n    initFrameCache: function () {\n        cc.loader.loadRes(\"number\", cc.LabelAtlas, function (err, atlas) {\n            GameTools.numberLabelAtlas = atlas;\n        });\n    },\n    initWxSetting: function () {\n        if (CC_WECHATGAME) {\n            window.wx.onHide(function () {//监听小游戏隐藏到后台事件\n                if (GameConfig.loadingSceneType == GameConfig.LoadingSceneType.LoadingSceneEnterGame && !GameConfig.IS_GAME_OVER) {\n                    GameData.loadGameData(false);\n                    GameTools.stopBackgroundMusic();\n                }\n            });\n            window.wx.onShow(() => {\n                if (GameConfig.loadingSceneType == GameConfig.LoadingSceneType.LoadingSceneEnterGame && !GameConfig.IS_GAME_OVER) {\n                    if (GameConfig.IS_GAME_MUSIC) {\n                        GameTools.playBackgroundMusic();\n                    }\n                }\n            });\n            window.wx.onAudioInterruptionBegin(() => {\n                GameTools.stopBackgroundMusic();\n            });\n            window.wx.onAudioInterruptionEnd(() => {//监听音频中断结束\n                if (GameConfig.loadingSceneType == GameConfig.LoadingSceneType.LoadingSceneEnterGame && !GameConfig.IS_GAME_OVER) {\n                    if (GameConfig.IS_GAME_MUSIC) {\n                        GameTools.playBackgroundMusic();\n                    }\n                }\n            });\n            window.wx.showShareMenu({withShareTicket: true});\n            window.wx.onShareAppMessage(function () {\n                // 用户点击了“转发”按钮\n                return {\n                    title: '来跟我一起挑战浪漫2048。',\n                    imageUrl: canvas.toTempFilePathSync({\n                        destWidth: 500,\n                        destHeight: 400\n                    })\n                }\n            });\n            let LaunchOption = wx.getLaunchOptionsSync();\n            if (LaunchOption.query != {} && LaunchOption.query.x != undefined) {\n                GameConfig.MAIN_MENU_NUM = Number(LaunchOption.query.x);\n            }\n            let info = window.wx.getSystemInfoSync();\n            GameConfig.GameClubButton = window.wx.createGameClubButton({\n                icon: 'green',\n                style: {\n                    left: info.windowWidth / 2 + 25,\n                    top: info.windowHeight * 90 / 100,\n                    width: 40,\n                    height: 40\n                }\n            });\n            GameConfig.GameClubButton.hide()\n        } else {\n            // GameTools.getRankData(\"测试群排行\");\n        }\n    },\n});\n"]}